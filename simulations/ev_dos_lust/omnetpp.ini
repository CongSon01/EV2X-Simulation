# =============================================================================
# OMNeT++ configuration for EV DoS Attack on LuST (Luxembourg) scenario
# Based on VeReMi paper (SecureComm 2018) configuration
# Adapted: standard vehicles replaced by EVs with battery logic
# =============================================================================

[General]
network = EVDoSLuSTScenario

# --- VeReMi timing: firstStepAt controls density ---
# Low density:  start = 3h  (03:00 AM, ~few hundred vehicles)
# Medium:       start = 5h  (05:00 AM, ~1000 vehicles)
# High density: start = 7h  (07:00 AM, ~2000+ vehicles, morning rush)
# sim-time-limit = firstStepAt + 100s (VeReMi style)
# Default for 7h configs: 7h + 100s = 25300s
sim-time-limit = 25300s

cmdenv-express-mode = true
cmdenv-autoflush = true
cmdenv-status-frequency = 10s

# --- Qtenv performance: reduce GUI overhead for large scenarios ---
qtenv-default-run = 0
*.visualizer.typename = "IntegratedCanvasVisualizer"
*.visualizer.*.displayDefaults = false

# Repeat 5 times with different seeds (VeReMi default)
repeat = 5
seed-set = ${repetition}
*.veinsManager.seed = ${repetition}

# Recording (vectors disabled for performance with 2000+ vehicles)
**.scalar-recording = true
**.vector-recording = false
output-vector-file = ${resultdir}/${configname}-${runnumber}.vec
output-scalar-file = ${resultdir}/${configname}-${runnumber}.sca

# =============================================================================
# Constraint area for LuST map (approx 0,0 to 13640,11500)
# Required by INET's MobilityBase to avoid NaN from uniform(-inf,inf)
# =============================================================================
**.constraintAreaMinX = 0m
**.constraintAreaMinY = 0m
**.constraintAreaMinZ = 0m
**.constraintAreaMaxX = 13640m
**.constraintAreaMaxY = 11500m
**.constraintAreaMaxZ = 50m

# =============================================================================
# Visualizer (disable heavy rendering for large scenarios)
# =============================================================================
*.visualizer.*.mobilityVisualizer.displayMobility = false
*.visualizer.*.mobilityVisualizer.displayPositions = false
*.visualizer.*.mediumVisualizer.displaySignals = false
*.visualizer.*.mediumVisualizer.displayTransmissions = false
*.visualizer.*.mediumVisualizer.displayReceptions = false
*.visualizer.*.dataLinkVisualizer.displayLinks = false
*.visualizer.*.networkRouteVisualizer.displayRoutes = false
*.visualizer.*.interfaceTableVisualizer.displayInterfaceTables = false
*.visualizer.*.packetDropVisualizer.displayPacketDrops = false

# =============================================================================
# SUMO-OMNeT++ connection (Veins TraCI)
# =============================================================================
*.veinsManager.updateInterval = 0.1s
*.veinsManager.host = "localhost"
*.veinsManager.port = 9999
*.veinsManager.autoShutdown = true
*.veinsManager.launchConfig = xmldoc("luxembourg.launchd.xml")

# Note: dua.static.sumocfg is sent via luxembourg.launchd.xml <copy type="config">

# Module type: our EV car with battery logic
*.veinsManager.moduleType = "evattack.veins_inet.VeinsInetEVCar"
*.veinsManager.moduleName = "ev"

# ROI (Region of Interest) - VeReMi uses this to limit the area
# Only vehicles inside this rectangle are simulated in OMNeT++
# VeReMi ROI: x=2300..6300, y=5400..6300 (4km x 0.9km downtown area)
*.veinsManager.roiRects = "2300,5400-6300,6300"

# firstStepAt: SUMO fast-forwards to this time before OMNeT++ starts
# This is how VeReMi controls traffic density
# 7h = 25200s = 7:00 AM (high density, morning rush hour)
*.veinsManager.firstStepAt = 7h

# IP configurator
*.configurator.config = xmldoc("config.xml")
*.configurator.addStaticRoutes = false
*.configurator.addDefaultRoutes = false
*.configurator.addSubnetRoutes = false
*.configurator.addDirectRoutes = false
*.configurator.optimizeRoutes = false

# =============================================================================
# Radio Medium - IEEE 802.11p (5.9 GHz DSRC)
# =============================================================================
*.radioMedium.mediumLimitCache.carrierFrequency = 5.9GHz

# Two-ray interference: realistic V2X range without physicalEnvironment module
*.radioMedium.pathLoss.typename = "TwoRayInterference"

# Range limits: avoid O(n^2) computation with 2000+ vehicles
# 20mW at 5.9GHz with two-ray model ~ 300m effective range
*.radioMedium.mediumLimitCache.maxCommunicationRange = 500m
*.radioMedium.mediumLimitCache.maxInterferenceRange = 750m

# No neighbor cache: brute-force with maxCommunicationRange is fast enough
# for ~100-300 vehicles in ROI. GridNeighborCache was removed because its
# refillCellsTimer (1 event/sec) blocked simulation during firstStepAt warmup.

# =============================================================================
# EV Configuration (dynamic nodes from SUMO)
# =============================================================================
*.ev[*].numApps = 1
*.ev[*].app[0].typename = "VeinsInetEVDoSApplication"
*.ev[*].app[0].interfaceTableModule = "^.interfaceTable"
*.ev[*].app[0].interface = "wlan0"

# Mobility - driven by SUMO via Veins
*.ev[*].mobility.typename = "VeinsInetMobility"

# IP auto-config
*.ev[*].ipv4.configurator.typename = "HostAutoConfigurator"
*.ev[*].ipv4.configurator.interfaces = "wlan0"

# Radio: IEEE 802.11p at 5.9 GHz (VeReMi uses 20mW TX power)
*.ev[*].wlan[0].typename = "Ieee80211Interface"
*.ev[*].wlan[0].radio.typename = "Ieee80211ScalarRadio"
*.ev[*].wlan[0].radio.bandName = "5.9 GHz"
*.ev[*].wlan[0].radio.channelNumber = 3
*.ev[*].wlan[0].radio.transmitter.power = 20mW
*.ev[*].wlan[0].radio.receiver.sensitivity = -89dBm
*.ev[*].wlan[0].radio.receiver.snirThreshold = 4dB
*.ev[*].wlan[0].mgmt.typename = "Ieee80211MgmtAdhoc"
*.ev[*].wlan[0].mac.dcf.channelAccess.cwMin = 15
*.ev[*].wlan[0].mac.dcf.channelAccess.cwMax = 1023
*.ev[*].wlan[0].radio.displayCommunicationRange = false

# Default: all EVs are NOT attackers
*.ev[*].app[0].isAttacker = false

# =============================================================================
# Charging Station (CS) Configuration - 3 stations within ROI
# =============================================================================
*.cs[*].numApps = 1
*.cs[*].app[0].typename = "VeinsInetReceiverApp"

*.cs[*].ipv4.configurator.typename = "HostAutoConfigurator"
*.cs[*].ipv4.configurator.interfaces = "wlan0"

# CS positions within ROI (2300,5400 - 6300,6300)
# Placed at locations representing real Luxembourg charging points
# initFromDisplayString=false: force INET to use our initialX/Y/Z params
*.cs[*].mobility.initFromDisplayString = false
*.cs[0].mobility.typename = "StationaryMobility"
*.cs[0].mobility.initialX = 3200m
*.cs[0].mobility.initialY = 5700m
*.cs[0].mobility.initialZ = 0m

*.cs[1].mobility.typename = "StationaryMobility"
*.cs[1].mobility.initialX = 4500m
*.cs[1].mobility.initialY = 5900m
*.cs[1].mobility.initialZ = 0m

*.cs[2].mobility.typename = "StationaryMobility"
*.cs[2].mobility.initialX = 5800m
*.cs[2].mobility.initialY = 5600m
*.cs[2].mobility.initialZ = 0m

*.cs[*].numWlanInterfaces = 1
*.cs[*].wlan[0].typename = "Ieee80211Interface"
*.cs[*].wlan[0].radio.typename = "Ieee80211ScalarRadio"
*.cs[*].wlan[0].radio.bandName = "5.9 GHz"
*.cs[*].wlan[0].radio.channelNumber = 3
*.cs[*].wlan[0].radio.transmitter.power = 20mW
*.cs[*].wlan[0].radio.receiver.sensitivity = -89dBm
*.cs[*].wlan[0].mgmt.typename = "Ieee80211MgmtAdhoc"
*.cs[*].wlan[0].mac.dcf.channelAccess.cwMin = 15
*.cs[*].wlan[0].mac.dcf.channelAccess.cwMax = 1023
*.cs[*].wlan[0].radio.displayCommunicationRange = false

# =============================================================================
# RSU Configuration - 5 RSUs at major intersections within ROI
# =============================================================================
*.rsu[*].numApps = 1
*.rsu[*].app[0].typename = "VeinsInetReceiverApp"

*.rsu[*].ipv4.configurator.typename = "HostAutoConfigurator"
*.rsu[*].ipv4.configurator.interfaces = "wlan0"

# RSU positions within ROI (2300,5400 - 6300,6300)
# Placed at intersections for optimal coverage
# initFromDisplayString=false: force INET to use our initialX/Y/Z params
*.rsu[*].mobility.initFromDisplayString = false
*.rsu[0].mobility.typename = "StationaryMobility"
*.rsu[0].mobility.initialX = 2800m
*.rsu[0].mobility.initialY = 5500m
*.rsu[0].mobility.initialZ = 10m

*.rsu[1].mobility.typename = "StationaryMobility"
*.rsu[1].mobility.initialX = 3800m
*.rsu[1].mobility.initialY = 5800m
*.rsu[1].mobility.initialZ = 10m

*.rsu[2].mobility.typename = "StationaryMobility"
*.rsu[2].mobility.initialX = 4800m
*.rsu[2].mobility.initialY = 6000m
*.rsu[2].mobility.initialZ = 10m

*.rsu[3].mobility.typename = "StationaryMobility"
*.rsu[3].mobility.initialX = 5500m
*.rsu[3].mobility.initialY = 5800m
*.rsu[3].mobility.initialZ = 10m

*.rsu[4].mobility.typename = "StationaryMobility"
*.rsu[4].mobility.initialX = 6000m
*.rsu[4].mobility.initialY = 6100m
*.rsu[4].mobility.initialZ = 10m

*.rsu[*].numWlanInterfaces = 1
*.rsu[*].wlan[0].typename = "Ieee80211Interface"
*.rsu[*].wlan[0].radio.typename = "Ieee80211ScalarRadio"
*.rsu[*].wlan[0].radio.bandName = "5.9 GHz"
*.rsu[*].wlan[0].radio.channelNumber = 3
*.rsu[*].wlan[0].radio.transmitter.power = 200mW
*.rsu[*].wlan[0].radio.receiver.sensitivity = -89dBm
*.rsu[*].wlan[0].mgmt.typename = "Ieee80211MgmtAdhoc"
*.rsu[*].wlan[0].mac.dcf.channelAccess.cwMin = 15
*.rsu[*].wlan[0].mac.dcf.channelAccess.cwMax = 1023
*.rsu[*].wlan[0].radio.displayCommunicationRange = false

# =============================================================================
# Scenario 1: EV to EV DoS Attack (High Density)
# =============================================================================
[Config EVtoEV_DoS_HighDensity]
description = "EV-to-EV DoS attack on LuST map, 7AM high density"

*.veinsManager.firstStepAt = 7h

# ev[0] is the attacker (first vehicle spawned in ROI)
*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "EV"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 30s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B

# =============================================================================
# Scenario 2: EV to CS DoS Attack (High Density)
# =============================================================================
[Config EVtoCS_DoS_HighDensity]
description = "EV-to-CS DoS attack on LuST map, 7AM high density"

*.veinsManager.firstStepAt = 7h

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "CS"
*.ev[0].app[0].targetAddress = "cs[0]"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 30s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B

# =============================================================================
# Scenario 3: EV to RSU DoS Attack (High Density)
# =============================================================================
[Config EVtoRSU_DoS_HighDensity]
description = "EV-to-RSU DoS attack on LuST map, 7AM high density"

*.veinsManager.firstStepAt = 7h

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "RSU"
*.ev[0].app[0].targetAddress = "rsu[0]"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 30s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B

# =============================================================================
# Scenario 4: All Types Mixed DoS (High Density)
# =============================================================================
[Config AllTypes_DoS_HighDensity]
description = "Mixed DoS attack targeting all communication types, LuST 7AM"

*.veinsManager.firstStepAt = 7h

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "Mixed"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 30s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B
*.ev[0].app[0].ev2evRange = 1500m
*.ev[0].app[0].ev2csRange = 800m
*.ev[0].app[0].ev2rsuRange = 1500m

# =============================================================================
# Scenario 5: EV to EV DoS - Medium Density (5AM)
# =============================================================================
[Config EVtoEV_DoS_MediumDensity]
description = "EV-to-EV DoS attack on LuST map, 5AM medium density"
sim-time-limit = 18100s  # 5h + 100s

*.veinsManager.firstStepAt = 5h

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "EV"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 30s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B

# =============================================================================
# Scenario 6: EV to EV DoS - Low Density (3AM)
# =============================================================================
[Config EVtoEV_DoS_LowDensity]
description = "EV-to-EV DoS attack on LuST map, 3AM low density"
sim-time-limit = 10900s  # 3h + 100s

*.veinsManager.firstStepAt = 3h

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "EV"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 30s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B

# =============================================================================
# LIGHTWEIGHT CONFIGS - For interactive testing (no long SUMO warm-up)
# Uses dua.light.sumocfg: 1/3 routes, no buses, short duration
# firstStepAt = 1800s (30min) = fast SUMO warm-up (~30 seconds)
# No ROI restriction = all vehicles visible on map
# =============================================================================

# --- Light Scenario 7: EV to EV DoS (quick test) ---
[Config Light_EVtoEV_DoS]
description = "LIGHT: EV-to-EV DoS, 30min warm-up, few dozen vehicles"
sim-time-limit = 1900s   # 30min + 100s

# Light SUMO config: fewer route files, shorter simulation
*.veinsManager.launchConfig = xmldoc("light.launchd.xml")
*.veinsManager.firstStepAt = 1800s

# No ROI: show ALL vehicles on the map (at 30min, few vehicles exist)
*.veinsManager.roiRects = ""

# ev[0] is attacker
*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "EV"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 60s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B

# --- Light Scenario 8: EV to CS DoS (quick test) ---
[Config Light_EVtoCS_DoS]
description = "LIGHT: EV-to-CS DoS, 30min warm-up"
sim-time-limit = 1900s

*.veinsManager.launchConfig = xmldoc("light.launchd.xml")
*.veinsManager.firstStepAt = 1800s
*.veinsManager.roiRects = ""

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "CS"
*.ev[0].app[0].targetAddress = "cs[0]"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 60s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B

# --- Light Scenario 9: EV to RSU DoS (quick test) ---
[Config Light_EVtoRSU_DoS]
description = "LIGHT: EV-to-RSU DoS, 30min warm-up"
sim-time-limit = 1900s

*.veinsManager.launchConfig = xmldoc("light.launchd.xml")
*.veinsManager.firstStepAt = 1800s
*.veinsManager.roiRects = ""

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "RSU"
*.ev[0].app[0].targetAddress = "rsu[0]"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 60s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B

# --- Light Scenario 10: Mixed DoS (quick test) ---
[Config Light_AllTypes_DoS]
description = "LIGHT: Mixed DoS targeting EV+CS+RSU, 30min warm-up"
sim-time-limit = 1900s

*.veinsManager.launchConfig = xmldoc("light.launchd.xml")
*.veinsManager.firstStepAt = 1800s
*.veinsManager.roiRects = ""

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "Mixed"
*.ev[0].app[0].attackStartTime = 10s
*.ev[0].app[0].attackDuration = 60s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B
*.ev[0].app[0].ev2evRange = 1500m
*.ev[0].app[0].ev2csRange = 800m
*.ev[0].app[0].ev2rsuRange = 1500m

# =============================================================================
# [Charging_Base] - SINGLE PLACE for all shared parameters
# =============================================================================
# Edit battery, radio, charging, CS/RSU apps here. Both maps inherit this.
# This config is abstract (no network=) - always extend it with a Map_ config.
# =============================================================================
[Config Charging_Base]
sim-time-limit = 300s
repeat = 1

# Record vectors for SoC analysis (override General's vector-recording=false)
**.vector-recording = true

# Radio medium: use GridNeighborCache to reduce NaN cache stats
*.radioMedium.neighborCache.typename = "GridNeighborCache"
*.radioMedium.neighborCache.cellSizeX = 300m
*.radioMedium.neighborCache.cellSizeY = 300m
*.radioMedium.neighborCache.cellSizeZ = 100m

# Radio medium: FreeSpacePathLoss for small controlled scenarios
# (TwoRayInterference from [General] works too, but FreeSpace is simpler)
*.radioMedium.pathLoss.typename = "FreeSpacePathLoss"

# Veins manager: use EV Charging Car module
*.veinsManager.firstStepAt = 0s
*.veinsManager.roiRects = ""
*.veinsManager.moduleType = "evattack.veins_inet.VeinsInetEVChargingCar"
*.veinsManager.moduleName = "ev"

# --- EV app and mobility ---
*.ev[*].numApps = 1
*.ev[*].app[0].typename = "VeinsInetEVChargingApp"
*.ev[*].app[0].interface = "wlan0"
*.ev[*].app[0].interfaceTableModule = "^.interfaceTable"
*.ev[*].mobility.typename = "VeinsInetMobility"
*.ev[*].ipv4.configurator.typename = "HostAutoConfigurator"
*.ev[*].ipv4.configurator.interfaces = "wlan0"

# --- EV Radio: IEEE 802.11p at 5.9 GHz ---
*.ev[*].wlan[0].typename = "Ieee80211Interface"
*.ev[*].wlan[0].radio.typename = "Ieee80211ScalarRadio"
*.ev[*].wlan[0].radio.bandName = "5.9 GHz"
*.ev[*].wlan[0].radio.channelNumber = 3
*.ev[*].wlan[0].radio.transmitter.power = 20mW
*.ev[*].wlan[0].radio.receiver.sensitivity = -89dBm
*.ev[*].wlan[0].radio.receiver.snirThreshold = 4dB
*.ev[*].wlan[0].mgmt.typename = "Ieee80211MgmtAdhoc"
*.ev[*].wlan[0].mac.dcf.channelAccess.cwMin = 15
*.ev[*].wlan[0].mac.dcf.channelAccess.cwMax = 1023
*.ev[*].wlan[0].radio.displayCommunicationRange = true

# --- Battery & Charging (edit these to tune SoC behavior) ---
*.ev[*].app[0].batteryCapacity = 200Wh 
*.ev[*].app[0].initialSoC = 0.8
*.ev[*].app[0].energyPerMeter = 0.05Wh 
*.ev[*].app[0].chargingPowerW = 7200W
*.ev[*].app[0].socThreshold = 0.2
*.ev[*].app[0].chargingRange = 300m          # wireless: send ChargeReq within 300m
*.ev[*].app[0].physicalChargingRange = 15m   # physical: start charging within 15m of CS
*.ev[*].app[0].csEdgeId = "B1B2"             # SUMO edge at CS location (rerouting target)
*.ev[*].app[0].isAttacker = false

# --- SUMO colors (default: all yellow, overridden per-vehicle below) ---
*.ev[*].app[0].sumoColor = "yellow"

# --- CS app ---
*.cs[*].numApps = 1
*.cs[*].app[0].typename = "VeinsInetCSChargingApp"
*.cs[*].app[0].interfaceTableModule = "^.interfaceTable"
*.cs[*].app[0].maxSlots = 1
*.cs[*].app[0].csBatteryCapacity = 50000Wh
*.cs[*].app[0].initialCSSoC = 1.0
*.cs[*].app[0].chargingPowerW = 7200W
*.cs[*].app[0].gridRechargePowerW = 10000W
*.cs[*].ipv4.configurator.typename = "HostAutoConfigurator"
*.cs[*].ipv4.configurator.interfaces = "wlan0"
*.cs[*].mobility.initFromDisplayString = false

# --- CS radio ---
*.cs[*].numWlanInterfaces = 1
*.cs[*].wlan[0].typename = "Ieee80211Interface"
*.cs[*].wlan[0].radio.typename = "Ieee80211ScalarRadio"
*.cs[*].wlan[0].radio.bandName = "5.9 GHz"
*.cs[*].wlan[0].radio.channelNumber = 3
*.cs[*].wlan[0].radio.transmitter.power = 20mW
*.cs[*].wlan[0].radio.receiver.sensitivity = -89dBm
*.cs[*].wlan[0].mgmt.typename = "Ieee80211MgmtAdhoc"
*.cs[*].wlan[0].mac.dcf.channelAccess.cwMin = 15
*.cs[*].wlan[0].mac.dcf.channelAccess.cwMax = 1023
*.cs[*].wlan[0].radio.displayCommunicationRange = true

# --- RSU app ---
*.rsu[*].numApps = 1
*.rsu[*].app[0].typename = "VeinsInetReceiverApp"
*.rsu[*].ipv4.configurator.typename = "HostAutoConfigurator"
*.rsu[*].ipv4.configurator.interfaces = "wlan0"
*.rsu[*].mobility.initFromDisplayString = false

# --- RSU radio ---
*.rsu[*].numWlanInterfaces = 1
*.rsu[*].wlan[0].typename = "Ieee80211Interface"
*.rsu[*].wlan[0].radio.typename = "Ieee80211ScalarRadio"
*.rsu[*].wlan[0].radio.bandName = "5.9 GHz"
*.rsu[*].wlan[0].radio.channelNumber = 3
*.rsu[*].wlan[0].radio.transmitter.power = 200mW
*.rsu[*].wlan[0].radio.receiver.sensitivity = -89dBm
*.rsu[*].wlan[0].mgmt.typename = "Ieee80211MgmtAdhoc"
*.rsu[*].wlan[0].mac.dcf.channelAccess.cwMin = 15
*.rsu[*].wlan[0].mac.dcf.channelAccess.cwMax = 1023
*.rsu[*].wlan[0].radio.displayCommunicationRange = true

# =============================================================================
# [Map_LuST] - Large LuST map (13.6km x 11.5km)
# =============================================================================
# CS/RSU positioned along the -30528 highway.primary road.
# Use this for realistic large-scale evaluation.
# =============================================================================
[Config Map_LuST]
network = ControlledEVDoSScenario
sim-time-limit = 500s

**.constraintAreaMinX = 0m
**.constraintAreaMinY = 0m
**.constraintAreaMinZ = 0m
**.constraintAreaMaxX = 13640m
**.constraintAreaMaxY = 11500m
**.constraintAreaMaxZ = 100m

*.veinsManager.launchConfig = xmldoc("controlled.launchd.xml")

# CS at (7350,5500) - along edge -30528#21
*.cs[0].mobility.typename = "StationaryMobility"
*.cs[0].mobility.initialX = 7350m
*.cs[0].mobility.initialY = 5500m
*.cs[0].mobility.initialZ = 0m

# Override csEdgeId for LuST map (default B1B2 is toy-only)
*.ev[*].app[0].csEdgeId = "-30528#21"

# RSU at (7400,5800) - along edge -30528#16
*.rsu[0].mobility.typename = "StationaryMobility"
*.rsu[0].mobility.initialX = 7400m
*.rsu[0].mobility.initialY = 5800m
*.rsu[0].mobility.initialZ = 10m

# =============================================================================
# [Map_Toy] - Small 3x3 grid (400m x 400m)
# =============================================================================
# Easy to visualize: all nodes visible in one Qtenv screen.
# Grid nodes: A0-A2 (x=0), B0-B2 (x=200), C0-C2 (x=400).
# Use this for debugging and quick visual verification.
# =============================================================================
[Config Map_Toy]
network = ToyEVDoSScenario
sim-time-limit = 500s

**.constraintAreaMinX = -10m
**.constraintAreaMinY = -10m
**.constraintAreaMinZ = 0m
**.constraintAreaMaxX = 500m
**.constraintAreaMaxY = 500m
**.constraintAreaMaxZ = 100m

*.veinsManager.launchConfig = xmldoc("toy.launchd.xml")

# CS at grid center B1 (200,200)
*.cs[0].mobility.typename = "StationaryMobility"
*.cs[0].mobility.initialX = 200m
*.cs[0].mobility.initialY = 200m
*.cs[0].mobility.initialZ = 0m

# RSU between B1 and B2 (200,300)
*.rsu[0].mobility.typename = "StationaryMobility"
*.rsu[0].mobility.initialX = 200m
*.rsu[0].mobility.initialY = 300m
*.rsu[0].mobility.initialZ = 10m

# =============================================================================
# RUNNABLE SCENARIOS (pick one of these in the OMNeT++ Run dialog)
# =============================================================================

# --- LuST + DoS Attack ---
[Config LuST_DoS]
extends = Charging_Base, Map_LuST
description = "LuST map: 2 EVs, 1 CS, 1 RSU. ev[0]=attacker(red). Charging protocol."

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "CS"
*.ev[0].app[0].targetAddress = "cs[0]"
*.ev[0].app[0].attackStartTime = 15s
*.ev[0].app[0].attackDuration = 120s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B
*.ev[0].app[0].sumoColor = "red"

# --- LuST + No Attack (baseline for comparison) ---
[Config LuST_Baseline]
extends = Charging_Base, Map_LuST
description = "LuST map BASELINE: Same setup, NO attacker. For comparison."

# --- Toy + DoS Attack ---
[Config Toy_DoS]
extends = Charging_Base, Map_Toy
description = "Toy grid: 2 EVs, 1 CS, 1 RSU. ev[0]=attacker(red). Easy to visualize."

# Higher energy/m on toy grid so SoC drops faster (0.1 Wh/m vs 0.05)
# At 0.1 Wh/m, EV needs ~1200m to reach 20% SoC -> triggers charging
*.ev[*].app[0].energyPerMeter = 0.1Wh

*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "CS"
*.ev[0].app[0].targetAddress = "cs[0]"
*.ev[0].app[0].attackStartTime = 15s
*.ev[0].app[0].attackDuration = 60s
*.ev[0].app[0].packetInterval = 0.01s
*.ev[0].app[0].packetSize = 1024B
*.ev[0].app[0].sumoColor = "red"

# --- Toy + No Attack (baseline) ---
[Config Toy_Baseline]
extends = Charging_Base, Map_Toy
description = "Toy grid BASELINE: Same setup, NO attacker. For comparison."
*.ev[*].app[0].energyPerMeter = 0.1Wh

# =============================================================================
# [Toy_Synchronized] - 4-State Demonstration
# =============================================================================
# Designed to capture all 4 states clearly in CSV output:
#
#  State 1 — Not Charging, Not Under Attack  (t = 0  ..  20s)
#  State 2 — Not Charging, Under Attack      (t = 20 ..  45s)
#  State 4 — Charging    , Under Attack      (t = 45 ..  80s)  [overlap]
#  State 3 — Charging    , Not Under Attack  (t = 80 .. 120s)  [attack ends]
#
# Timeline design:
#   - ev[0] is the attacker. It starts attacking at t=20s for 60s (ends t=80s).
#     ev[0] has high initial SoC (0.8) so it won't need charging itself.
#
#   - ev[1] is the victim EV. initialSoC=0.4 means it starts with 80 Wh.
#     energyPerMeter=0.1 Wh/m. It needs to drive 400m to reach 20% (40 Wh).
#     At ~10 m/s SUMO speed that takes ~40s -> threshold reached at ~t=40s.
#     -> ev[1] sends ChargeReq inside the attack window (t=20..80s).
#     -> After wirelessly requesting AND driving to CS (within 2m), it charges.
#     -> Charging session spans t≈45s to t≈80s+ depending on battery fill rate.
#     -> If attack ends at t=80s and ev[1] is still charging: that is State 3.
#
#   physicalChargingRange = 2m: EV must drive to within 2 meters of CS to plug in.
#   chargingRange          = 300m: EV sends the wireless ChargeReq within 300m.
# =============================================================================
[Config Toy_Synchronized]
extends = Charging_Base, Map_Toy
description = "4-State demo: physical plug-in (2m), ev[1] charging during DoS attack."

sim-time-limit = 300s

*.cs[*].wlan[0].mac.queue.packetCapacity = 10
*.cs[*].wlan[0].mac.queue.typename = "DropTailQueue"

# Higher energy drain so SoC changes are visible within 200s
*.ev[*].app[0].energyPerMeter = 0.1Wh
*.ev[*].app[0].batteryCapacity = 200Wh

# --- ev[0]: Attacker ---
# Attacks from t=20s to t=80s. Stays at high SoC so it never charges.
*.ev[0].app[0].isAttacker = true
*.ev[0].app[0].targetType = "CS"
*.ev[0].app[0].targetAddress = "cs[0]"
*.ev[0].app[0].attackStartTime = 10s     # State 2 begins here
*.ev[0].app[0].attackDuration = 60s      # Attack ends at t=80s
*.ev[0].app[0].packetInterval = 0.001s    # 100 pkts/s flood
*.ev[0].app[0].packetSize = 1024B
*.ev[0].app[0].initialSoC = 0.80         # 160 Wh -> won't reach threshold in 200s
*.ev[0].app[0].sumoColor = "red"

# Physical charging range for ev[0] (attacker still has this feature)
*.ev[0].app[0].chargingRange = 300m
*.ev[0].app[0].physicalChargingRange = 50m
*.ev[0].app[0].csEdgeId = "B1B2"

# --- ev[1]: Normal EV (victim) ---
# initialSoC=0.4 -> 80 Wh. Needs to drain 40 Wh to reach 20% threshold.
# At 0.1 Wh/m and ~10 m/s: drain takes ~400m / 10m/s = ~40s of driving.
# -> ev[1] reaches threshold at approximately t=40s (inside attack window).
# -> EV auto-reroutes to CS edge B1B2. When within 10m, begins charging.
*.ev[1].app[0].isAttacker = false
*.ev[1].app[0].initialSoC = 0.30         # 80 Wh -> hits threshold after ~400m
*.ev[1].app[0].packetInterval = 1s    # 1 pkts/s
*.ev[1].app[0].chargingRange = 300m
*.ev[1].app[0].physicalChargingRange = 50m
*.ev[1].app[0].csEdgeId = "B1B2"
*.ev[1].app[0].sumoColor = "yellow"
